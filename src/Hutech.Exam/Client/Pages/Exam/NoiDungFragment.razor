

@if (!string.IsNullOrEmpty(NoiDung))
{
	// xử lí câu hỏi latex
	if (NoiDung.Contains("<latex"))
	{
		List<string> latex = HandleLatex(NoiDung);
		foreach (var segment in latex)
		{
			@if (segment.Contains("$$"))
			{
				<span style="color: @((isNoiDungCha) ?  "#2e7d32" : "")"><Hutech.Exam.Client.Pages.Latext.Equation Value="@segment.Substring(2)" /></span>
			}
			else
			{
				<span style="color: @((isNoiDungCha) ?  "#2e7d32" : "")">@((MarkupString)segment)</span>
			}
		}
	}
	else
	{
		<span style="color: @((isNoiDungCha) ?  "#2e7d32" : "")">@((MarkupString)(NoiDung))</span>
	}
}


@code {
	[Parameter] public string NoiDung { get; set; } = string.Empty;
	[Parameter] public bool isNoiDungCha { get; set; } = false;

	private string color = "#000000";

	private static List<string> HandleLatex(string text)
	{
		List<string> result = new();
		if (!text.Contains("<latex>"))
			return [text];

		string[] parts = text.Split("<latex>");

		// xử lí phần đầu chắc chắn không có latex hoặc là thuần latex
		if (!string.IsNullOrEmpty(parts[0]))
			result.Add(parts[0]);

		for (int i = 1; i < parts.Length; i++)
		{
			// phần cắt này chỉ có 2 phần duy nhất
			string[] parts2 = parts[i].Split("</latex>");

			// xử lí phần đầu chắc chắn là latex
			result.Add("$$" + parts2[0]);

			// / phần còn lại là chữ hoặc không có nếu là thuần latex
			if (parts2.Length > 1 && !string.IsNullOrEmpty(parts2[1]))
				result.Add(parts2[1]);
		}

		return result;
	}
}
